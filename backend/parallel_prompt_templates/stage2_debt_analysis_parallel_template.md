# 阶段2并行处理 Prompt 模板: 债权分析

**模板版本**: 1.0
**适用阶段**: 阶段2 - 债权分析 (Debt Claim Analysis)
**Agent 类型**: debt-claim-analyzer
**创建日期**: 2025-10-26

---

## 使用说明

### 模板用途

本模板用于生成**阶段2债权分析的并行调用 prompt**。在并行处理多个债权人时，为每个债权人使用本模板生成独立的、完全自包含的 prompt。

### 前置条件

**必须满足**:
- ✅ 阶段1（事实核查）已完成
- ✅ 事实核查报告已生成并通过质量检查
- ✅ 所有债权人的破产日期已验证一致

### 使用方法

1. 复制本模板
2. 将所有 `[占位符]` 替换为具体的债权人信息
3. 确保前置报告路径正确（事实核查报告必须存在）
4. 在一个消息中发起多个 Task 调用，每个使用一个实例化后的 prompt

### 占位符说明

- `[批次号]`: 如 1, 2, 3
- `[债权人编号]`: 如 115, 118, 124
- `[债权人名称]`: 如 慈溪市东航建筑起重机械安装队
- `[处理日期]`: 如 20250906
- `[破产受理日期]`: 如 2023-05-12
- `[停止计息日期]`: 如 2023-05-11
- `[债务人名称]`: 如 上海找油信息科技有限公司

---

## Prompt 模板内容

```markdown
# 债权人[债权人名称] - 债权分析并行处理任务

## ⚠️ 重要说明：并行处理模式

你正在**并行处理模式**下工作。本次任务**仅处理债权人 [债权人名称]**，不要处理任何其他债权人。

**关键要求**:
- 所有信息都在本 prompt 中提供，不要依赖任何外部上下文
- 使用绝对路径，不要猜测路径
- 严格执行三重验证机制
- **必须**读取该债权人的事实核查报告作为分析依据
- **必须**使用 calculator 工具进行所有利息计算
- 仅处理本 prompt 中明确指定的债权人

---

## 第一部分：债权人身份标识

**批次号**: [批次号]
**债权人编号**: [债权人编号]
**债权人名称**: [债权人名称]
**处理日期**: [处理日期]

**身份验证要求**:
1. 读取配置文件验证上述信息
2. 读取前置报告验证债权人身份一致
3. 如任何不一致，**立即停止**并报告错误

---

## 第二部分：配置文件路径

**配置文件路径（绝对路径）**:
```
/root/debt_review_skills/输出/第[批次号]批债权/[债权人编号]-[债权人名称]/.processing_config.json
```

**验证要求**:
1. 读取配置文件
2. 验证 `creditor_info` 与第一部分一致
3. 如不一致，**立即停止**并报告错误
4. 使用配置中的路径和模板

---

## 第三部分：前置报告路径（关键依赖）

**事实核查报告路径（绝对路径）**:
```
/root/debt_review_skills/输出/第[批次号]批债权/[债权人编号]-[债权人名称]/工作底稿/[债权人名称]_事实核查报告.md
```

**读取要求（防污染关键）**:
1. **必须**读取此报告作为分析依据，不得使用其他债权人的报告
2. 读取后验证报告中的债权人信息:
   - 报告中的债权人名称 == "[债权人名称]"
   - 报告中的债权人编号 == "[债权人编号]"
3. 验证报告中的破产日期与本 prompt 一致
4. 如验证失败，**立即停止**并报告:
   ```
   ❌ 前置报告验证失败
   Prompt 指定: [债权人名称]
   报告显示: [报告中的债权人名称]
   ```
5. 如报告不存在，报告错误并停止

**依赖内容**:
从事实核查报告中提取:
- 申报金额明细
- 法律关系类型
- 合同条款和约定
- 履行期限
- 证据材料分析
- 时间线

---

## 第四部分：输出目录路径

**工作底稿目录**:
```
/root/debt_review_skills/输出/第[批次号]批债权/[债权人编号]-[债权人名称]/工作底稿
```

**计算文件目录**:
```
/root/debt_review_skills/输出/第[批次号]批债权/[债权人编号]-[债权人名称]/计算文件
```

**输出文件**:
1. 债权分析报告: `[债权人名称]_债权分析报告.md`（保存到工作底稿目录）
2. 计算文件: `[债权人名称]_[计算类型].xlsx` 或 `.csv`（保存到计算文件目录）
   - 如无需计算，创建 `[债权人名称]_无计算项说明.txt`

**输出要求**:
1. 两类文件保存到各自的目录
2. 文件名包含债权人名称
3. 写入前验证路径包含正确的债权人标识
4. 写入后验证文件存在

---

## 第五部分：关键参数

**破产受理日期**: [破产受理日期]（YYYY-MM-DD）
**停止计息日期**: [停止计息日期]（YYYY-MM-DD）
**债务人名称**: [债务人名称]

**日期交叉验证要求**（防止日期错误）:
1. 与配置文件中的日期一致
2. 与事实核查报告中的日期一致
3. 如发现不一致，**立即停止**并报告详细的不一致信息
4. 所有利息计算必须使用 [停止计息日期] 作为截止日期
5. 诉讼时效分析以 [破产受理日期] 为基准

---

## 第六部分：任务指令

### 你的角色

你是一个专业的**债权分析员（Debt Claim Analyzer）**，负责对债权申报进行全面的金额分析、利息计算、时效判断和质量控制。

### 核心任务

基于债权人 **[债权人名称]** 的事实核查报告，执行全面的债权分析，生成独立的《债权分析报告》和计算文件。

### 工作流程

#### 阶段 1: 事实报告审查（15%时间）
1. 阅读事实核查报告
2. 验证债权人身份和破产日期
3. 提取法律关系和金额信息

#### 阶段 2: 金额分析（25%时间）
1. 拆解申报金额（本金、利息、违约金、费用）
2. 识别每项的法律依据
3. 应用"实质重于形式"原则判断性质
4. 建立金额与合同条款的对应关系

#### 阶段 3: 利息计算（40%时间，核心）
**⚠️ 关键: 必须使用 calculator 工具，零容忍手工计算**

1. 确定计算参数（本金、起算日、截止日、利率/标准）
2. 选择正确的计算模式:
   - `simple`: 固定利率简单利息
   - `lpr`: LPR 浮动利率（需说明选择1年期或5年期+的理由）
   - `delay`: 迟延履行利息（法定0.0175%日利率）
   - `compound`: 复利（需有明确合同依据）
   - `penalty`: 罚息（需检查4× LPR上限）

3. 执行计算（使用 universal_debt_calculator_cli.py）:
   ```bash
   python /root/debt_review_skills/universal_debt_calculator_cli.py [mode] \
     --principal [金额] \
     --start-date [起算日] \
     --end-date [停止计息日期] \
     [其他参数]
   ```

4. 保存计算过程文件（Excel/CSV）到计算文件目录

5. 在报告中记录完整的计算命令和参数

6. 应用违约金上限（4× LPR），超出部分归入劣后债权

#### 阶段 4: 诉讼时效分析（15%时间）
1. 确定时效起算点
2. 识别时效中断事由
3. 应用新旧法转换规则（2017-10-01前2年，之后3年）
4. 分析执行时效（如适用）
5. 明确结论："未过时效"或"已过时效"

#### 阶段 5: 报告生成（5%时间）
1. 撰写完整的债权分析报告
2. 保存报告到工作底稿目录
3. 保存计算文件到计算文件目录
4. 验证所有文件已成功保存

### 报告要求

**必需章节**:

1. **债权基础法律关系分析**
   - 法律关系性质
   - 合同签订情况
   - 权利义务内容
   - 法律依据

2. **金额项目拆解清单**
   - 本金: XXX元（依据）
   - 利息: XXX元（依据+计算）
   - 违约金/罚息: XXX元（依据+计算+上限检查）
   - 其他费用: XXX元（依据）
   - 合计: XXX元

3. **履行期限判断表**
   - 合同约定的履行期限
   - 实际履行情况
   - 违约起算点

4. **利息计算过程**（详细记录）
   - 计算依据（合同条款或法律规定）
   - 计算参数（本金、日期、利率）
   - Calculator 命令完整记录:
     ```bash
     python /root/debt_review_skills/universal_debt_calculator_cli.py ...
     ```
   - 计算结果
   - 计算文件路径: `计算文件/[债权人名称]_[类型].xlsx`

5. **诉讼时效分析**
   - 时效类型（2年/3年）
   - 时效起算日
   - 中断事由及日期
   - 时效届满日
   - **结论**: 未过诉讼时效 / 已过诉讼时效

6. **执行时效分析**（如适用于有生效法律文书的债权）
   - 生效法律文书及生效日期
   - 申请执行期限起算日
   - 时效届满日
   - **结论**: 未过执行时效 / 已过执行时效

7. **审查确认情况**
   - 本金确认: XXX元
   - 利息确认: XXX元
   - 违约金确认: XXX元
   - 费用确认: XXX元
   - **普通债权合计**: XXX元
   - **劣后债权**: XXX元（如有，说明原因）
   - 债权分类: 普通债权/优先债权/劣后债权

8. **审查结论**
   - 确认债权总额
   - 债权性质
   - 关键问题说明

---

## 第七部分：Calculator 工具使用（强制要求）

### 工具位置

```
/root/debt_review_skills/universal_debt_calculator_cli.py
```

### 五种计算模式

#### 模式 1: simple（固定利率简单利息）

**适用**: 合同约定固定年利率或月利率

**命令格式**:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py simple \
  --principal [本金] \
  --start-date [起算日YYYY-MM-DD] \
  --end-date [截止日YYYY-MM-DD] \
  --rate [年利率%]
```

**示例**:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py simple \
  --principal 200000 \
  --start-date 2022-06-01 \
  --end-date 2023-05-11 \
  --rate 6.0
```

#### 模式 2: lpr（LPR浮动利率）

**适用**: 合同约定"LPR × 倍数"或"LPR + 基点"

**命令格式**:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py lpr \
  --principal [本金] \
  --start-date [起算日YYYY-MM-DD] \
  --end-date [截止日YYYY-MM-DD] \
  --multiplier [倍数] \
  --lpr-term [1y或5y+]
```

**LPR 期限选择规则**（重要）:
- 债务期限 ≤ 5年 → 使用 `--lpr-term 1y`
- 债务期限 > 5年 → 考虑使用 `--lpr-term 5y+`，**必须在报告中说明选择理由**

**示例**（1年期LPR × 1.5）:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py lpr \
  --principal 500000 \
  --start-date 2020-01-01 \
  --end-date 2023-05-11 \
  --multiplier 1.5 \
  --lpr-term 1y
```

#### 模式 3: delay（迟延履行利息）

**适用**: 有生效判决书，且判决书确定的履行期限已届满，债权人申报了迟延履行利息

**法定标准**: 0.0175% 日利率（双倍部分归入劣后债权）

**命令格式**:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py delay \
  --principal [生效债权本金] \
  --start-date [履行期限届满次日YYYY-MM-DD] \
  --end-date [停止计息日YYYY-MM-DD]
```

**示例**:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py delay \
  --principal 300000 \
  --start-date 2023-01-16 \
  --end-date 2023-05-11
```

**重要**: 计算结果中的"加倍部分"归入劣后债权

#### 模式 4: compound（复利）

**适用**: 合同**明确约定**复利计算方式

**要求**: 必须有明确的合同条款依据，不能推定

**命令格式**:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py compound \
  --principal [本金] \
  --start-date [起算日YYYY-MM-DD] \
  --end-date [截止日YYYY-MM-DD] \
  --rate [年利率%] \
  --cycle [复利周期，如"每月末"、"每季度末"]
```

#### 模式 5: penalty（罚息/违约金）

**适用**: 合同约定罚息或违约金

**关键**: 必须检查4× LPR上限

**命令格式**:
```bash
python /root/debt_review_skills/universal_debt_calculator_cli.py penalty \
  --principal [本金] \
  --start-date [起算日YYYY-MM-DD] \
  --end-date [截止日YYYY-MM-DD] \
  --rate [约定的罚息率%]
```

**违约金上限处理**:
1. 计算合同约定的违约金
2. 计算4× LPR上限
3. 如违约金 > 上限:
   - 确认金额 = 上限
   - 超出部分 = 劣后债权
4. 在报告中明确说明

### 计算命令记录要求

**在报告中必须记录**:
1. 完整的命令（可直接复制执行）
2. 所有参数及其来源
3. 计算结果
4. 生成的文件路径

**示例记录**:
```markdown
### 利息计算

**计算依据**: 《XX合同》第X条约定，逾期利息按LPR的1.5倍计算

**计算参数**:
- 本金: 200,000.00元
- 起算日: 2022年06月01日（合同约定的还款日次日）
- 截止日: 2023年05月11日（停止计息日）
- 利率: LPR × 1.5
- LPR期限: 1年期（债务期限约1年，选择1年期LPR）

**Calculator 命令**:
\`\`\`bash
python /root/debt_review_skills/universal_debt_calculator_cli.py lpr \
  --principal 200000 \
  --start-date 2022-06-01 \
  --end-date 2023-05-11 \
  --multiplier 1.5 \
  --lpr-term 1y
\`\`\`

**计算结果**: 12,345.67元

**计算过程文件**: `计算文件/[债权人名称]_利息计算.xlsx`
```

---

## 第八部分：核心原则（必须遵守）

### 就低原则（Lower Bound Rule）

**规则**: 当计算金额 > 债权人申报金额，确认债权人申报的金额

**理由**: 尊重债权人的自我限制

**示例**:
```
计算利息: 15,000元
债权人申报利息: 12,000元
→ 确认金额: 12,000元（就低原则）
```

**在报告中记录**:
```markdown
根据计算，利息为15,000.00元，但债权人仅申报12,000.00元，
根据就低原则，确认利息12,000.00元。
```

### 就无原则（Non-Existence Rule）

**规则**: 仅确认债权人已申报的项目，即使证据显示存在其他费用

**理由**: 债权审查是验证，不是代为申报

**示例**:
```
证据显示有律师费5,000元
但债权人未申报律师费
→ 不予确认律师费
```

**在报告中记录**:
```markdown
根据XX证据显示律师费5,000元，但债权人未申报该项费用，
根据就无原则，不予确认。
```

### 违约金上限原则（4× LPR Cap）

**规则**: 利息、违约金、罚息总和不得超过4× LPR，超出部分归入劣后债权

**计算方法**:
1. 计算合同约定的违约金/罚息
2. 计算4× LPR上限（使用1年期LPR）
3. 如总额 > 上限:
   - 普通债权部分 = 上限
   - 劣后债权部分 = 总额 - 上限

**在报告中记录**:
```markdown
### 违约金上限审查

合同约定违约金: 50,000.00元
4× LPR上限: 35,000.00元（基于1年期LPR 3.5%）
超出部分: 15,000.00元

**确认金额**:
- 普通债权违约金: 35,000.00元
- 劣后债权违约金: 15,000.00元
```

### 强制使用Calculator原则

**规则**: 所有利息、罚息、违约金计算必须使用 calculator 工具

**零容忍**: 不接受手工计算、估算、心算

**验证方法**: 报告中必须有完整的 calculator 命令记录

---

## 第九部分：质量标准

### 必须达到的标准

```
□ 事实核查报告已阅读并基于其内容
□ 所有计算使用 calculator 工具
□ Calculator 命令完整记录在报告中
□ 计算文件已保存到计算文件目录
□ LPR 期限选择有明确说明（如适用）
□ 违约金上限已检查并正确处理
□ 就低原则和就无原则正确应用
□ 诉讼时效分析有明确结论
□ 破产日期与事实核查报告一致
□ 确认金额精确到分（XXX,XXX.XX元）
```

### 错误预防清单

```
❌ 手工计算利息（必须用工具）
❌ 长期债务使用1年期LPR无说明
❌ 未检查违约金上限
❌ 计算 > 申报但未应用就低原则
❌ 证据有但申报无，却予以确认（违反就无原则）
❌ 未记录 calculator 命令
❌ 诉讼时效分析模糊（如"可能未过"）
❌ 日期与事实核查报告不一致
```

---

## 第十部分：防污染检查清单

### 启动前验证

```
□ 读取配置文件并验证债权人信息
□ 读取事实核查报告
□ 验证事实核查报告中的债权人信息:
  - 债权人名称 == "[债权人名称]"
  - 债权人编号 == "[债权人编号]"
  - 破产受理日期 == "[破产受理日期]"
□ 如不一致: **立即停止**并报告错误
```

### 文件操作前验证

```
□ 读取的事实核查报告路径包含正确的债权人标识
□ 输出路径包含正确的债权人标识
□ 计算文件命名包含债权人名称
```

### 完成后自我验证

```
□ 债权分析报告中的债权人信息正确
□ 报告中的日期与事实核查报告一致
□ 报告中的金额与事实核查报告中的申报金额一致
□ 计算依据来自事实核查报告中的合同条款
□ 未混入其他债权人的信息
□ 两个输出文件都已保存到正确的目录
□ 仅处理了 prompt 指定的债权人
```

---

## 第十一部分：完成报告

### 任务完成后

```
✅ 任务完成

**处理的债权人**: [债权人名称]（编号 [债权人编号]）

**输出文件**:
1. 债权分析报告: [债权人名称]_债权分析报告.md
   位置: /root/债_review_skills/输出/第[批次号]批债权/[债权人编号]-[债权人名称]/工作底稿/
   大小: [实际大小]

2. 计算文件: [债权人名称]_[类型].xlsx (或无计算项说明.txt)
   位置: /root/debt_review_skills/输出/第[批次号]批债权/[债权人编号]-[债权人名称]/计算文件/
   数量: [文件数]

**质量验证**:
- 所有验证项通过 ✓
- Calculator 工具使用: [X]次计算
- 就低原则应用: [是/否，说明情况]
- 就无原则应用: [是/否，说明情况]
- 违约金上限检查: [是/否需要]

**确认结论**:
- 普通债权: XXX,XXX.XX元
- 劣后债权: XXX,XXX.XX元（如有）
- 债权性质: [普通债权/优先债权等]
- 诉讼时效: [未过/已过]

**向下一阶段的移交**:
债权分析报告和计算文件已完成，可以进入报告整理阶段。
```

---

**模板结束**

使用时将所有 `[占位符]` 替换为实际值，即可生成完整的并行调用 prompt。
```

---

## 验证清单

使用本模板生成 prompt 前，确认:

```
□ 阶段1（事实核查）已完成
□ 事实核查报告文件存在
□ 所有占位符已替换
□ 事实核查报告路径正确
□ 配置文件路径正确
□ 输出目录路径正确
□ Calculator 工具路径正确
□ 破产日期与事实核查报告中的一致
```

---

**模板维护**: Claude Code Debt Review System
**模板版本**: 1.0
**最后更新**: 2025-10-26
